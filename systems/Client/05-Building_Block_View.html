<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Building Block View | Wikibase Architecture Documentation</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="I&#39;m all about architecture">
    
    <link rel="preload" href="/wikidata-wikibase-architecture/assets/css/0.styles.2dde6f7c.css" as="style"><link rel="preload" href="/wikidata-wikibase-architecture/assets/js/app.3df8c736.js" as="script"><link rel="preload" href="/wikidata-wikibase-architecture/assets/js/2.c572fd67.js" as="script"><link rel="preload" href="/wikidata-wikibase-architecture/assets/js/3.495dc00b.js" as="script"><link rel="prefetch" href="/wikidata-wikibase-architecture/assets/js/10.dc434baf.js"><link rel="prefetch" href="/wikidata-wikibase-architecture/assets/js/11.663dfe7c.js"><link rel="prefetch" href="/wikidata-wikibase-architecture/assets/js/12.c6eea1e3.js"><link rel="prefetch" href="/wikidata-wikibase-architecture/assets/js/13.ba724b6d.js"><link rel="prefetch" href="/wikidata-wikibase-architecture/assets/js/14.2cda7156.js"><link rel="prefetch" href="/wikidata-wikibase-architecture/assets/js/15.c3a4a02a.js"><link rel="prefetch" href="/wikidata-wikibase-architecture/assets/js/16.684cd25b.js"><link rel="prefetch" href="/wikidata-wikibase-architecture/assets/js/17.dca34912.js"><link rel="prefetch" href="/wikidata-wikibase-architecture/assets/js/18.4ee0b86b.js"><link rel="prefetch" href="/wikidata-wikibase-architecture/assets/js/19.08ce7f36.js"><link rel="prefetch" href="/wikidata-wikibase-architecture/assets/js/20.cfb89aad.js"><link rel="prefetch" href="/wikidata-wikibase-architecture/assets/js/21.4442f59d.js"><link rel="prefetch" href="/wikidata-wikibase-architecture/assets/js/22.b856b12e.js"><link rel="prefetch" href="/wikidata-wikibase-architecture/assets/js/23.5f6cbd6b.js"><link rel="prefetch" href="/wikidata-wikibase-architecture/assets/js/24.e6a0ece3.js"><link rel="prefetch" href="/wikidata-wikibase-architecture/assets/js/25.f746e6fd.js"><link rel="prefetch" href="/wikidata-wikibase-architecture/assets/js/26.c90048a7.js"><link rel="prefetch" href="/wikidata-wikibase-architecture/assets/js/27.6d1148f6.js"><link rel="prefetch" href="/wikidata-wikibase-architecture/assets/js/28.60572beb.js"><link rel="prefetch" href="/wikidata-wikibase-architecture/assets/js/29.39167d9f.js"><link rel="prefetch" href="/wikidata-wikibase-architecture/assets/js/30.0709fb88.js"><link rel="prefetch" href="/wikidata-wikibase-architecture/assets/js/31.452f63a1.js"><link rel="prefetch" href="/wikidata-wikibase-architecture/assets/js/32.cba61a06.js"><link rel="prefetch" href="/wikidata-wikibase-architecture/assets/js/33.82ca7843.js"><link rel="prefetch" href="/wikidata-wikibase-architecture/assets/js/34.69840246.js"><link rel="prefetch" href="/wikidata-wikibase-architecture/assets/js/35.ea21d817.js"><link rel="prefetch" href="/wikidata-wikibase-architecture/assets/js/36.3f986831.js"><link rel="prefetch" href="/wikidata-wikibase-architecture/assets/js/37.b6b55d26.js"><link rel="prefetch" href="/wikidata-wikibase-architecture/assets/js/38.95e0021b.js"><link rel="prefetch" href="/wikidata-wikibase-architecture/assets/js/39.b9ce5ef6.js"><link rel="prefetch" href="/wikidata-wikibase-architecture/assets/js/4.b6f95212.js"><link rel="prefetch" href="/wikidata-wikibase-architecture/assets/js/40.f25881a3.js"><link rel="prefetch" href="/wikidata-wikibase-architecture/assets/js/41.5b2f986c.js"><link rel="prefetch" href="/wikidata-wikibase-architecture/assets/js/42.4bce698c.js"><link rel="prefetch" href="/wikidata-wikibase-architecture/assets/js/43.521bd05c.js"><link rel="prefetch" href="/wikidata-wikibase-architecture/assets/js/44.eebe792a.js"><link rel="prefetch" href="/wikidata-wikibase-architecture/assets/js/45.741f30e0.js"><link rel="prefetch" href="/wikidata-wikibase-architecture/assets/js/46.2cd47454.js"><link rel="prefetch" href="/wikidata-wikibase-architecture/assets/js/47.afa25a33.js"><link rel="prefetch" href="/wikidata-wikibase-architecture/assets/js/48.a0fb3eea.js"><link rel="prefetch" href="/wikidata-wikibase-architecture/assets/js/49.177db5ee.js"><link rel="prefetch" href="/wikidata-wikibase-architecture/assets/js/5.ebca04eb.js"><link rel="prefetch" href="/wikidata-wikibase-architecture/assets/js/50.a898602b.js"><link rel="prefetch" href="/wikidata-wikibase-architecture/assets/js/51.a980c670.js"><link rel="prefetch" href="/wikidata-wikibase-architecture/assets/js/52.d575af35.js"><link rel="prefetch" href="/wikidata-wikibase-architecture/assets/js/53.95cfbe6e.js"><link rel="prefetch" href="/wikidata-wikibase-architecture/assets/js/54.51250cc2.js"><link rel="prefetch" href="/wikidata-wikibase-architecture/assets/js/55.dfd80371.js"><link rel="prefetch" href="/wikidata-wikibase-architecture/assets/js/56.583775b7.js"><link rel="prefetch" href="/wikidata-wikibase-architecture/assets/js/57.87c80b7e.js"><link rel="prefetch" href="/wikidata-wikibase-architecture/assets/js/58.cd2db007.js"><link rel="prefetch" href="/wikidata-wikibase-architecture/assets/js/59.a7300c15.js"><link rel="prefetch" href="/wikidata-wikibase-architecture/assets/js/6.dcdb223b.js"><link rel="prefetch" href="/wikidata-wikibase-architecture/assets/js/60.7e618cd7.js"><link rel="prefetch" href="/wikidata-wikibase-architecture/assets/js/7.4ce1ed3f.js"><link rel="prefetch" href="/wikidata-wikibase-architecture/assets/js/8.caf216c7.js"><link rel="prefetch" href="/wikidata-wikibase-architecture/assets/js/9.68cd709e.js">
    <link rel="stylesheet" href="/wikidata-wikibase-architecture/assets/css/0.styles.2dde6f7c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/wikidata-wikibase-architecture/" class="home-link router-link-active"><!----> <span class="site-name">Wikibase Architecture Documentation</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/wikidata-wikibase-architecture/" class="nav-link">
  Wikibase
</a></div><div class="nav-item"><a href="/wikidata-wikibase-architecture/systems/Repository/01-Introduction.html" class="nav-link">
  Repository
</a></div><div class="nav-item"><a href="/wikidata-wikibase-architecture/systems/Query/01-Introduction.html" class="nav-link">
  Query Service
</a></div><div class="nav-item"><a href="/wikidata-wikibase-architecture/systems/Client/01-Introduction.html" class="nav-link">
  Client
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/wikidata-wikibase-architecture/" class="nav-link">
  Wikibase
</a></div><div class="nav-item"><a href="/wikidata-wikibase-architecture/systems/Repository/01-Introduction.html" class="nav-link">
  Repository
</a></div><div class="nav-item"><a href="/wikidata-wikibase-architecture/systems/Query/01-Introduction.html" class="nav-link">
  Query Service
</a></div><div class="nav-item"><a href="/wikidata-wikibase-architecture/systems/Client/01-Introduction.html" class="nav-link">
  Client
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/wikidata-wikibase-architecture/systems/Client/01-Introduction.html" class="sidebar-link">Client Introduction</a></li><li><a href="/wikidata-wikibase-architecture/systems/Client/02-Architecture_Constraints.html" class="sidebar-link">Architecture Constraints</a></li><li><a href="/wikidata-wikibase-architecture/systems/Client/03-Context_and_Scope.html" class="sidebar-link">Context and Scope</a></li><li><a href="/wikidata-wikibase-architecture/systems/Client/04-Solution_Strategy.html" class="sidebar-link">Solution Strategy</a></li><li><a href="/wikidata-wikibase-architecture/systems/Client/05-Building_Block_View.html" aria-current="page" class="active sidebar-link">Building Block View</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/wikidata-wikibase-architecture/systems/Client/05-Building_Block_View.html#whitebox-overall-system" class="sidebar-link">Whitebox Overall System</a></li></ul></li><li><a href="/wikidata-wikibase-architecture/systems/Client/06-Runtime_View.html" class="sidebar-link">Runtime View</a></li><li><a href="/wikidata-wikibase-architecture/systems/Client/07-Deployment_View.html" class="sidebar-link">Deployment View</a></li><li><a href="/wikidata-wikibase-architecture/systems/Client/09-Architecture_Decisions.html" class="sidebar-link">Architecture Decisions</a></li><li><a href="/wikidata-wikibase-architecture/systems/Client/10-Quality.html" class="sidebar-link">Quality Requirements</a></li><li><a href="/wikidata-wikibase-architecture/systems/Client/11-Risks_and_Technical_Debt.html" class="sidebar-link">Risks and Technical Debt</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="building-block-view"><a href="#building-block-view" class="header-anchor">#</a> Building Block View</h1> <p><img src="/wikidata-wikibase-architecture/assets/img/legend.drawio.482452e3.svg" alt="Legend"></p> <h2 id="whitebox-overall-system"><a href="#whitebox-overall-system" class="header-anchor">#</a> Whitebox Overall System</h2> <p><img src="/wikidata-wikibase-architecture/assets/img/05-building-blocks.drawio.a471f021.svg" alt=""></p> <table><thead><tr><th>Building Block</th> <th>Responsibility</th></tr></thead> <tbody><tr><td><a href="#apis">APIs</a></td> <td>Represent domain data through MediaWiki APIs</td></tr> <tr><td><a href="#entity-data-access">Entity Data Access</a></td> <td>Access <a href="/wikidata-wikibase-architecture/Glossary.html#entity">Entities</a> from a Repository</td></tr> <tr><td><a href="#usage">Usage Tracking</a></td> <td>Tracking the usage of Repository Entities on a Client</td></tr> <tr><td><a href="#entity-change-notifications">Entity Change Notifications</a></td> <td>Be notified about and act on changes to Entities on a Repository</td></tr> <tr><td><a href="#linked-site-page-changes">Linked Site Page Changes</a></td> <td>Inform a Repository of changes to <a href="/wikidata-wikibase-architecture/Glossary.html#connected-pages">pages that are linked</a> to Repository <a href="/wikidata-wikibase-architecture/Glossary.html#item">Items</a></td></tr> <tr><td><a href="#data-bridge">Data Bridge</a></td> <td>Edit Item <a href="/wikidata-wikibase-architecture/Glossary.html#datavalue">data values</a> on the Repository</td></tr> <tr><td><a href="#special-pages">Special Pages</a></td> <td>WikibaseClient specific <a href="/wikidata-wikibase-architecture/Glossary.html#special-page">Special Pages</a></td></tr> <tr><td><a href="#interwiki">Interwiki</a></td> <td>Client side interactions with <a href="/wikidata-wikibase-architecture/Glossary.html#interwiki-links">Interwiki links</a></td></tr></tbody></table> <details class="custom-block details"><summary>Legacy detailed views</summary> <p>The future of this detailed content is undecided...</p> <h4 id="apis"><a href="#apis" class="header-anchor">#</a> APIs</h4> <h5 id="action-api-description"><a href="#action-api-description" class="header-anchor">#</a> <a href="https://www.wikidata.org/w/api.php?action=help&amp;modules=query%2Bdescription" target="_blank" rel="noopener noreferrer">Action API Description<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h5> <p><img src="/wikidata-wikibase-architecture/assets/img/05-api-description.drawio.c75958b1.svg" alt="Action API Description Building Block Diagram"></p> <table><thead><tr><th>Building Block</th> <th>Type/Context</th> <th>Responsibility</th></tr></thead> <tbody><tr><td>DescriptionLookup</td> <td>Lookups</td> <td>Lookup client <a href="/wikidata-wikibase-architecture/Glossary.html#description">descriptions</a> from a variety of sources</td></tr> <tr><td>RepoLinker</td> <td>Response</td> <td>Creates links to Repository Entity concepts</td></tr></tbody></table> <h5 id="action-api-entityusage"><a href="#action-api-entityusage" class="header-anchor">#</a> <a href="https://www.wikidata.org/w/api.php?action=help&amp;modules=query%2Bwbentityusage" target="_blank" rel="noopener noreferrer">Action API EntityUsage<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h5> <p><img src="/wikidata-wikibase-architecture/assets/img/05-api-entityusage.drawio.f5dca67a.svg" alt="Action API EntityUsage Building Block Diagram"></p> <table><thead><tr><th>Building Block</th> <th>Type/Context</th> <th>Responsibility</th></tr></thead> <tbody><tr><td>RepoLinker</td> <td>Response</td> <td>Creates links to Repository Entity concepts</td></tr></tbody></table> <h5 id="action-api-meta-wikibase"><a href="#action-api-meta-wikibase" class="header-anchor">#</a> <a href="https://www.wikidata.org/w/api.php?action=help&amp;modules=query%2Bwikibase" target="_blank" rel="noopener noreferrer">Action API Meta Wikibase<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h5> <p><img src="/wikidata-wikibase-architecture/assets/img/05-api-metawikibase.drawio.3fac3da1.svg" alt="Action API Meta Building Block Diagram"></p> <table><thead><tr><th>Building Block</th> <th>Type/Context</th> <th>Responsibility</th></tr></thead> <tbody><tr><td>SettingsArray</td> <td>Config</td> <td>WikibaseClient settings containing meta information</td></tr></tbody></table> <h5 id="action-api-page-terms"><a href="#action-api-page-terms" class="header-anchor">#</a> <a href="https://www.wikidata.org/w/api.php?action=help&amp;modules=query%2Bpageterms" target="_blank" rel="noopener noreferrer">Action API Page Terms<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h5> <p><img src="/wikidata-wikibase-architecture/assets/img/05-api-pageterms.drawio.0acb7f54.svg" alt="Action API Page Terms Building Block Diagram"></p> <table><thead><tr><th>Building Block</th> <th>Type/Context</th> <th>Responsibility</th></tr></thead> <tbody><tr><td>EntityIdLookup</td> <td>Lookups</td> <td>Lookup EntityIds from <a href="/wikidata-wikibase-architecture/Glossary.html#title">Titles</a></td></tr> <tr><td>TermBuffer</td> <td>Lookups</td> <td>Lookup buffered <a href="/wikidata-wikibase-architecture/Glossary.html#term">Terms</a></td></tr> <tr><td>AliasTermBuffer</td> <td>Lookups</td> <td>Lookup buffered <a href="/wikidata-wikibase-architecture/Glossary.html#alias">Aliases</a></td></tr> <tr><td>RepoLinker</td> <td>Response</td> <td>Creates links to Repository Entity concepts</td></tr></tbody></table> <h5 id="action-api-format-reference"><a href="#action-api-format-reference" class="header-anchor">#</a> Action API Format Reference</h5> <p><img src="/wikidata-wikibase-architecture/assets/img/05-api-wbformatreference.drawio.88de5bb5.svg" alt="Action API Format Reference Building Block Diagram"></p> <table><thead><tr><th>Building Block</th> <th>Type/Context</th> <th>Responsibility</th></tr></thead> <tbody><tr><td>Deserializer (Reference)</td> <td>Input</td> <td>Get <a href="/wikidata-wikibase-architecture/Glossary.html#reference">Reference</a> objects from user input</td></tr> <tr><td>ReferenceFormatter</td> <td>Format Reference</td> <td>Format Reference as wikitext</td></tr> <tr><td>Parser</td> <td>Output</td> <td>Parse Reference wikitext and output HTML</td></tr></tbody></table> <h4 id="entity-data-access"><a href="#entity-data-access" class="header-anchor">#</a> Entity Data Access</h4> <p><img src="/wikidata-wikibase-architecture/assets/img/05-entitydataaccess.drawio.40646c62.svg" alt="Entity Data Access"></p> <table><thead><tr><th>Building Block</th> <th>Responsibility</th></tr></thead> <tbody><tr><td><a href="#shared-entity-data-access">Shared</a></td> <td>Services shared between multiple types of entity data access (lookups, formatters, utilities)</td></tr> <tr><td><a href="#parserfunctions">ParserFunctions</a></td> <td>MediaWiki <a href="/wikidata-wikibase-architecture/Glossary.html#parser-function">parser function</a> binding for entity data access</td></tr> <tr><td><a href="#scribunto">Scribunto</a></td> <td>Scribunto extension binding for entity data access</td></tr></tbody></table> <h5 id="shared-entity-data-access"><a href="#shared-entity-data-access" class="header-anchor">#</a> Shared (Entity Data Access)</h5> <p><img src="/wikidata-wikibase-architecture/assets/img/05-entitydataaccess-shared.drawio.89a3e1be.svg" alt="Entity Data Access Shared"></p> <table><thead><tr><th>Building Block</th> <th>Responsibility</th></tr></thead> <tbody><tr><td>SnakFormatter</td> <td>Formats <a href="/wikidata-wikibase-architecture/Glossary.html#snak">Snaks</a> in a client context</td></tr> <tr><td>ReferenceFormatter</td> <td>Formats references in a client context</td></tr> <tr><td>StatementTransclusionInteractor</td> <td>Renders the main snaks associated with a given Property on an Entity</td></tr> <tr><td>EntityTitleLookup</td> <td>Resolves a specific sitelink on a specific Item to a <a href="/wikidata-wikibase-architecture/Glossary.html#title">Title</a></td></tr> <tr><td>PropertyIdResolver</td> <td>Resolves a PropertyId from input which could be a <a href="/wikidata-wikibase-architecture/Glossary.html#label">Label</a> or prefixed ID</td></tr> <tr><td>SnaksFinder</td> <td>Find Snaks for claims in a given Entity, based on PropertyId</td></tr></tbody></table> <h5 id="parserfunctions"><a href="#parserfunctions" class="header-anchor">#</a> ParserFunctions</h5> <p><img src="/wikidata-wikibase-architecture/assets/img/05-entitydataaccess-parserfunctions.drawio.e9b361fa.svg" alt="Entity Data Access Parser Functions"></p> <table><thead><tr><th>Building Block</th> <th>Responsibility</th></tr></thead> <tbody><tr><td>Runner</td> <td>Contains the methods called by MediaWiki when <a href="/wikidata-wikibase-architecture/Glossary.html#parser-function">parser functions</a> are used</td></tr> <tr><td>StatementGroupRenderer</td> <td>Renderer for rendering a <a href="/wikidata-wikibase-architecture/Glossary.html#statement">statement</a> group</td></tr></tbody></table> <h5 id="scribunto"><a href="#scribunto" class="header-anchor">#</a> Scribunto</h5> <p><img src="/wikidata-wikibase-architecture/assets/img/05-entitydataaccess-scribunto.drawio.cb2a96dc.svg" alt="Entity Data Access Scribunto"></p> <table><thead><tr><th>Building Block</th> <th>Responsibility</th></tr></thead> <tbody><tr><td>TermLookup</td> <td>Lookup terms of Entities for use in LUA</td></tr> <tr><td>Scribunto_LuaLibraryBase</td> <td>Registers and defined methods called by the Scribunto extension</td></tr> <tr><td>LanguageDependentLuaBindings</td> <td>Actual implementations of various functions that can be accessed through Scribunto.</td></tr> <tr><td>LanguageIndependentLuaBindings</td> <td>Actual implementations of various functions that can be accessed through Scribunto.</td></tr> <tr><td>LuaEntityBindings</td> <td>Actual implementations of various functions that can be accessed through Scribunto.</td></tr> <tr><td>SnakSerializationRenderer</td> <td>Renders snaks for LUA</td></tr> <tr><td>EntityAccessor</td> <td>Miscellaneous functionality for exposing Entities through LUA</td></tr> <tr><td>LuaFunctionCallTracker</td> <td>Helper for tracking accesses of Lua functions</td></tr></tbody></table> <h4 id="entity-change-notifications"><a href="#entity-change-notifications" class="header-anchor">#</a> Entity Change Notifications</h4> <p><img src="/wikidata-wikibase-architecture/assets/img/05-entitychangenotifications.drawio.975d0127.svg" alt=""></p> <table><thead><tr><th>Building Block</th> <th>Responsibility</th></tr></thead> <tbody><tr><td><a href="#changes">Changes</a></td> <td>Receive and handle regular Repository Entity Data changes</td></tr> <tr><td><a href="#change-modifications">ChangeModifications</a></td> <td>Receive and handle changes to the history of Repository Entities</td></tr> <tr><td><a href="#recent-changes">RecentChanges</a></td> <td>Represent changes to Repository Entities in a Client RecentChanges system</td></tr> <tr><td><a href="#usage">Usage</a></td> <td>Tracking the usage of Repository Entities on a Client</td></tr></tbody></table> <h5 id="changes"><a href="#changes" class="header-anchor">#</a> Changes</h5> <p><img src="/wikidata-wikibase-architecture/assets/img/05-entitychangenotifications-changes.drawio.7c7545f1.svg" alt=""></p> <table><thead><tr><th>Building Block</th> <th>Responsibility</th></tr></thead> <tbody><tr><td>AffectedPagesFinder</td> <td>Finds PageEntityUsages that are affected by a Change</td></tr> <tr><td>ChangeHandler</td> <td>Handles EntityChanges</td></tr> <tr><td>ChangeRunCoalescer</td> <td>A transformer for lists of EntityChanges that combines runs of changes into a single change</td></tr> <tr><td>InjectRCRecordsJob</td> <td>Persists RecentChanges entries</td></tr> <tr><td>PageUpdater</td> <td>Triggers various updates needed when pages will change</td></tr></tbody></table> <h5 id="change-modifications"><a href="#change-modifications" class="header-anchor">#</a> Change Modifications</h5> <p><img src="/wikidata-wikibase-architecture/assets/img/05-entitychangenotifications-modifications.drawio.e0891103.svg" alt=""></p> <table><thead><tr><th>Building Block</th> <th>Responsibility</th></tr></thead> <tbody><tr><td>ChangeModificationNotificationJob</td> <td>Base for handling Entity Revision changes</td></tr> <tr><td>ChangeDeletionNotificationJob</td> <td>Handles Repository Entity Revision Deletions</td></tr> <tr><td>ChangeVisibilityNotificationJob</td> <td>Handles Repository Entity Revision Visibility Changes</td></tr></tbody></table> <h5 id="recent-changes"><a href="#recent-changes" class="header-anchor">#</a> Recent Changes</h5> <p><img src="/wikidata-wikibase-architecture/assets/img/05-entitychangenotifications-recentchanges.drawio.396de692.svg" alt=""></p> <table><thead><tr><th>Building Block</th> <th>Responsibility</th></tr></thead> <tbody><tr><td>RecentChangesFinder</td> <td>Find RecentChange entries based on their meta data</td></tr> <tr><td>ExtenalChange</td> <td>Data object representing a revision that has changed an Entity on an external site</td></tr> <tr><td>RevisionData</td> <td>Data object representing a revision on an external site</td></tr> <tr><td>ChangeLineFormatter</td> <td>Formats and ExternalChange as HTML</td></tr> <tr><td>SiteLinkCommentCreator</td> <td>Deals with creating comment infomation relating to SiteLink changes</td></tr></tbody></table> <h4 id="usage"><a href="#usage" class="header-anchor">#</a> Usage</h4> <p><img src="/wikidata-wikibase-architecture/assets/img/05-entitychangenotifications-usage.drawio.2c0fac1b.svg" alt=""></p> <p>UsageAspectTransformer is only used outside of this block and perhaps shouldn't live here</p> <table><thead><tr><th>Building Block</th> <th>Responsibility</th></tr></thead> <tbody><tr><td>UsageLookup</td> <td>Find EntityUsages for pages</td></tr> <tr><td>EntityUsage</td> <td>Data object representing the usage of an Entity (but not identifying where it is used)</td></tr> <tr><td>PageEntityUsages</td> <td>Data object associating a EntityUsage with a Page ID</td></tr> <tr><td>UsageAccumulator</td> <td>Interface allowing accumulation of usage tracking information for a given page</td></tr> <tr><td>UsageTrackingSnakFormatter</td> <td>SnakFormatter implementation that will accumulate usage in a UsageAccumulator</td></tr> <tr><td>UsageTrackingLanguageFallbackLabelDescriptionLookup</td> <td>LanguageFallbackLabelDescriptionLookup implementation that will accumulate usage in a UsageAccumulator</td></tr> <tr><td>UsageDeduplicator</td> <td>De-duplicates entity usage listsfor performance and storage reasons</td></tr> <tr><td>SubscriptionManager</td> <td>Persists infomation about pages being &quot;subscribed&quot; to updates for an Entity</td></tr> <tr><td>UsageTracker</td> <td>Persists infomation about the EntityUsages of a page</td></tr> <tr><td>UsageAspectTransformer</td> <td>Transforms usage aspect based on a filter of aspects relevant in some context.</td></tr> <tr><td>BulkSubscriptionUpdater</td> <td>Bulk inserts for subscriptions into wb_changes_subscription based on wbc_entity_usage.</td></tr> <tr><td>AddUsagesForPageJob</td> <td>Job for scheduled invocation of UsageUpdater which is triggered by a MediaWiki hook related to Wikitext-based content edits.</td></tr> <tr><td>UsageUpdater</td> <td>Service for updating usage tracking and associated change subscription information.</td></tr> <tr><td>populateEntityUsage</td> <td>Maintenance script for populating wbc_entity_usage based on the page_props table.</td></tr> <tr><td>updateSubscriptions</td> <td>Maintenance script for inserting subscriptions into wb_changes_subscription based on wbc_entity_usage.</td></tr></tbody></table> <h4 id="linked-site-page-changes"><a href="#linked-site-page-changes" class="header-anchor">#</a> <a href="/wikidata-wikibase-architecture/Glossary.html#connected-pages">Linked Site Page</a> Changes</h4> <p><img src="/wikidata-wikibase-architecture/assets/img/05-linkedsitepagechanges.drawio.a5585e4b.svg" alt="Linked Site Page Changes"></p> <table><thead><tr><th>Building Block</th> <th>Responsibility</th></tr></thead> <tbody><tr><td>UpdateRepo</td> <td>Update the repository after certain changes have been performed in the client</td></tr> <tr><td>UpdateRepoOnDelete</td> <td>Update the repository after page deletes in the client</td></tr> <tr><td>UpdateRepoOnMove</td> <td>Update the repository after page moves in the client</td></tr></tbody></table> <h4 id="data-bridge"><a href="#data-bridge" class="header-anchor">#</a> Data Bridge</h4> <p>Data Bridge is a frontend component enabling Repository edits on the Client via the Repository API.</p> <p><img src="/wikidata-wikibase-architecture/assets/img/05-databridge.drawio.4ab5bd43.svg" alt="Data Bridge"></p> <table><thead><tr><th>Building Block</th> <th>Responsibility</th></tr></thead> <tbody><tr><td><a href="#data-access">Data Access</a></td> <td>A group of classes and interfaces for interacting with WikibaseRepo data and MediaWiki functionality</td></tr> <tr><td><a href="#presentation">Presentation</a></td> <td>UI components for presentation</td></tr> <tr><td>Store</td> <td>State management of the UI components</td></tr> <tr><td><a href="#mediawiki">MediaWiki</a></td> <td>Logic that has to do with Data Bridge attaching itself in the right places on the wiki article</td></tr> <tr><td><a href="#changeop">ChangeOp</a></td> <td>Strategies for applying changes (update or replace) to the entity</td></tr> <tr><td>Tracking</td> <td>Tracking data bridge usage and errors</td></tr></tbody></table> <h5 id="data-access"><a href="#data-access" class="header-anchor">#</a> Data Access</h5> <p><img src="/wikidata-wikibase-architecture/assets/img/05-databridge-dataaccess.drawio.6d188fc9.svg" alt="Data Bridge Data Access"></p> <table><thead><tr><th>Building Block</th> <th>Responsibility</th></tr></thead> <tbody><tr><td>Errors</td> <td>Provide context about errors that might occur in Data Bridge. The native Error TypeScript class is used</td></tr> <tr><td>ApiErrors</td> <td>Error returned from the Repo API</td></tr> <tr><td>Other Errors</td> <td>Error that may occur in Data Bridge and are not related to the API, e.g. an error on saving</td></tr> <tr><td>Repo API</td> <td>Implementations of WikibaseRepo API requests</td></tr> <tr><td>Reading API</td> <td>Implementations of WikibaseRepo API requests that have to do with reading from repository</td></tr> <tr><td>Writing API</td> <td>Implementations of WikibaseRepo API requests that have to do with writing to repository</td></tr> <tr><td>ApiEntityLabelRepository</td> <td>A repository to get the <a href="/wikidata-wikibase-architecture/Glossary.html#label">label</a> of specific entity in a specific language</td></tr> <tr><td>ApiPageEditPermissionErrorsRepository</td> <td>A repository for determining potential permission errors when editing a page.</td></tr> <tr><td>ApiPropertyDataTypeRepository</td> <td>A repository to get the <a href="/wikidata-wikibase-architecture/Glossary.html#datatype">datatype</a> of a property</td></tr> <tr><td>ApiRenderReferencesRepository</td> <td>A repository to render reference JSON blobs into HTML strings</td></tr> <tr><td>ApiReadingEntityRepository</td> <td>A repository for reading the latest revision of an entity.</td></tr> <tr><td>ApiRepoConfigRepository</td> <td>A repository to get the configuration from the Wikibase repository instance where the data is going to be saved</td></tr> <tr><td>ApiWritingRepository</td> <td>Saves the modified entity</td></tr> <tr><td>CombiningPermissionsRepository</td> <td>A repository for determining potential permission errors when using the Data Bridge</td></tr> <tr><td>TrimmingWritingRepository</td> <td>A WritingEntityRepository that compares the old and new entity data and sends parts that changed to an underlying ApiWritingRepository</td></tr> <tr><td>SpecialPageReadingEntityRepository</td> <td>A repository for reading the latest revision of an entity</td></tr></tbody></table> <h5 id="presentation"><a href="#presentation" class="header-anchor">#</a> Presentation</h5> <p><img src="/wikidata-wikibase-architecture/assets/img/05-databridge-presentation.drawio.58d6f29b.svg" alt="Data Bridge Presentation"></p> <table><thead><tr><th>Building Block</th> <th>Responsibility</th></tr></thead> <tbody><tr><td>UI Components</td> <td>All presentational components that construct Data Bridge's modal and its contents</td></tr> <tr><td>Plugins and Utilities</td> <td>Logic which is common for several components, e.g. representing messages from mw's i18n mechanism</td></tr> <tr><td>Error Components</td> <td>Front end components that represent an error which occurred in Data Bridge</td></tr> <tr><td>Call To Action Components</td> <td>Front end components that require an action from the user</td></tr> <tr><td>Base components</td> <td>Purely presentational components, e.g. a button. Those components will be replaced by Design System components in the future.</td></tr> <tr><td>Messages</td> <td>A wrapper around MediaWiki's i18n mechanism</td></tr> <tr><td>ClientRouter</td> <td>Format page urls for client</td></tr> <tr><td>RepoRouter</td> <td>Format page urls for a repository</td></tr> <tr><td>BridgeConfig</td> <td>Configuration needed in some UI components, e.g. the link for reporting issues with data bridge</td></tr></tbody></table> <h5 id="mediawiki"><a href="#mediawiki" class="header-anchor">#</a> MediaWiki</h5> <p><img src="/wikidata-wikibase-architecture/assets/img/05-databridge-mediawiki.drawio.829455d6.svg" alt="Data Bridge MediaWiki"></p> <table><thead><tr><th>Building Block</th> <th>Responsibility</th></tr></thead> <tbody><tr><td>Dispatcher</td> <td>Dispatches Data Bridge to the appropriate DOM element in the wiki article</td></tr> <tr><td>BridgeDomElementSelector</td> <td>Selects elements in a wiki article's DOM that can be overloaded with Data Bridge</td></tr> <tr><td>SelectedElement</td> <td>An interface which describes a DOM element to which Data Bridge is dispatched</td></tr> <tr><td>subscribeToEvents</td> <td>Actions taken on the wiki page when certain data bridge events occur. E.g. reload the page when the data bridge edit is saved</td></tr> <tr><td>prepareContainer</td> <td>Creates a container element based on OO.ui.Dialog in which Data Bridge is placed on the wiki page</td></tr> <tr><td>EventTracker</td> <td>An abstraction layer for MediaWiki's event tracker</td></tr></tbody></table> <h5 id="changeop"><a href="#changeop" class="header-anchor">#</a> ChangeOp</h5> <p><img src="/wikidata-wikibase-architecture/assets/img/05-databridge-changeop.drawio.4f52964d.svg" alt="Data Bridge Change Op"></p> <table><thead><tr><th>Building Block</th> <th>Responsibility</th></tr></thead> <tbody><tr><td>ReplaceMutationStrategy</td> <td>Strategy for replacing a <a href="/wikidata-wikibase-architecture/Glossary.html#statement">statement</a></td></tr> <tr><td>StatementMutationStrategy</td> <td>Interface for a statement mutation strategy</td></tr> <tr><td>UpdateMutationStrategy</td> <td>Strategy for updating a statement</td></tr> <tr><td>StatementMutationError</td> <td>Represents an error that can occur when mutating a statement</td></tr> <tr><td>StatementMutationFactory</td> <td>Chooses the right mutation strategy based on the edit decision (replace or update)</td></tr></tbody></table> <h4 id="special-pages"><a href="#special-pages" class="header-anchor">#</a> Special Pages</h4> <p><img src="/wikidata-wikibase-architecture/assets/img/05-special-pages.drawio.eaa67158.svg" alt="Special Pages Building Block Diagram"></p> <table><thead><tr><th>Building Block</th> <th>Type/Context</th> <th>Responsibility</th></tr></thead> <tbody><tr><td><a href="/wikidata-wikibase-architecture/Glossary.html#special-page">Special Pages</a></td> <td>WikibaseClient</td> <td>Provide entity usage meta information</td></tr> <tr><td>SpecialEntityUsage</td> <td>WikibaseClient</td> <td>Lists client wiki pages that use a given entity ID and the aspects they use</td></tr> <tr><td>SpecialPagesWithBadges</td> <td>WikibaseClient</td> <td>Shows a list of pages with a given <a href="/wikidata-wikibase-architecture/Glossary.html#badge">badge</a></td></tr> <tr><td>SpecialUnconnectedPages</td> <td>WikibaseClient</td> <td>Lists client pages that are not connected to repository items</td></tr></tbody></table> <h4 id="interwiki"><a href="#interwiki" class="header-anchor">#</a> Interwiki</h4> <p><img src="/wikidata-wikibase-architecture/assets/img/05-interwiki.drawio.2b7db1b7.svg" alt="Interwiki Building Block Diagram"></p> <table><thead><tr><th>Building Block</th> <th>Responsibility</th></tr></thead> <tbody><tr><td>populateInterwiki</td> <td>Maintenance script that populates the interwiki table in the client's MediaWiki DB with list of sites</td></tr></tbody></table></details></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/wmde/wikidata-wikibase-architecture/edit/main/systems/Client/05-Building_Block_View.md" target="_blank" rel="noopener noreferrer">Edit this page on Github!</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">4/4/2022, 8:05:53 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/wikidata-wikibase-architecture/systems/Client/04-Solution_Strategy.html" class="prev">
        Solution Strategy
      </a></span> <span class="next"><a href="/wikidata-wikibase-architecture/systems/Client/06-Runtime_View.html">
        Runtime View
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/wikidata-wikibase-architecture/assets/js/app.3df8c736.js" defer></script><script src="/wikidata-wikibase-architecture/assets/js/2.c572fd67.js" defer></script><script src="/wikidata-wikibase-architecture/assets/js/3.495dc00b.js" defer></script>
  </body>
</html>
